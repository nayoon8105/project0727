<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cafeComment">
	<sql id="cafeCommentColumn">
		num,writer,content,target_id,ref_group,comment_group,TO_CHAR(regdate,'YYYY-MM-DD PM HH:MI') regdate
	</sql>
	<insert id="insert" parameterType="cafeCommentDto">
		INSERT INTO board_cafe_comment
		(num,writer,content,target_id,ref_group,comment_group,regdate)
		VALUES(#{num},#{writer},#{content},#{target_id},#{ref_group},#{comment_group},SYSDATE) 
	</insert>
	<select id="getSequence" resultType="int">
		SELECT board_cafe_seq.NEXTVAL
		FROM DUAL
	</select>
	<select id="getList" parameterType="int" resultType="cafeCommentDto">
		SELECT <include refid="cafeCommentColumn"/>
		FROM board_cafe_comment
		WHERE ref_group=#{num}
		ORDER BY comment_group ASC, num ASC <!-- 댓글 그룹으로 정렬 후 같은 그룹 내에서 댓글 번호로 정렬 -->
	</select>
	<delete id="delete" parameterType="int">
		DELETE FROM board_cafe_comment
		WHERE num=#{num}
	</delete>
	<update id="update" parameterType="cafeCommentDto">
		UPDATE board_cafe_comment
		SET content=#{content}
		WHERE num=#{num}
	</update>
</mapper>